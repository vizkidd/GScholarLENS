(async()=>{let e=document.getElementById("perm-list"),s=document.getElementById("request-btn"),t=chrome.runtime.getManifest(),i=chrome.permissions?chrome.permissions:browser.permissions?browser.permissions:null,n=t.host_permissions||[],r=t.optional_permissions||[];n.forEach(s=>{let t=document.createElement("div");t.className="perm",t.textContent=`Site access: ${s}`,e.appendChild(t)}),r.forEach(s=>{let t=document.createElement("div");t.className="perm",t.textContent=`API permission: ${s}`,e.appendChild(t)}),s.addEventListener("click",async()=>{try{let e=await i.request({origins:n,permissions:r});e?(chrome.runtime.sendMessage({type:"permissions_granted"}),alert("Permissions granted! Thank you.")):alert("Permissions denied. Some features may not work."),window.close()}catch(s){console.error("Permission request failed",s),alert("An error occurred. See console for details.")}})})();