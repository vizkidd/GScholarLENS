function sendZeroCopyArr(e){let r=new TextEncoder,t=JSON.stringify(e),a=r.encode(t);self.postMessage(a.buffer,[a.buffer])}self.onmessage=async({data:e})=>{let{task:r,batch:t,retractionWatchDB:a}=e;try{if("checkRetraction"===r){for(let c of t){let o=!1,s=c.title;c.retracted=!1;let l=s.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:}=\_\'\"\(\)\[\]\{\}\+-`~)]/g,"").replace(/\s+/g,"").replace(/retracted/g,"").replace(/retraction/g,"");a.map(async e=>{if(o)return;let r=e.Title.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:}=\_\'\"\(\)\[\]\{\}\+-`~)]/g,"").replace(/\s+/g,"").replace(/retracted/g,"").replace(/retraction/g,"");l===r&&(o=!0,c.retracted=!0)});let n={type:"working",task:"checkRetraction",publication:c};sendZeroCopyArr(n)}let p={type:"done",task:r};sendZeroCopyArr(p)}}catch(i){let g={type:"error",task:r,error:i.message};sendZeroCopyArr(g)}};